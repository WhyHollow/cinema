import{p as B,r as i,c as m,q as l,d as k,a as z,h as q,b as H,n as I}from"./index-CtqZGGt3.js";import{_ as C}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Q=B("movies",()=>{const s=i([]),o=i(1),n=i(8),r=i(null),d=i([]),v=i([]),p=i(null),h=i(null),g=i({}),F=m(()=>Math.ceil(s.value.length/n.value)),T=e=>{e==="name"?s.value.sort((t,a)=>t.name.localeCompare(a.name)):e==="rating"&&s.value.sort((t,a)=>(a.rating||0)-(t.rating||0))},N=m(()=>{const e=(o.value-1)*n.value;return s.value.slice(e,e+n.value)}),A=async()=>{try{const e=await l.get("/movies");s.value=e.data.data.map(t=>{const a=f(t.additional);return{...t,rating:parseFloat(a["Рейтинг Imdb"]||"0")}}),s.value=s.value.sort((t,a)=>t.name.localeCompare(a.name))}catch(e){console.error("Помилка завантаження фільмів:",e)}},D=async e=>{var t;try{const a=await l.get("/movies/",{params:{movie_id:e}});r.value=a.data.data[0],f((t=r.value)==null?void 0:t.additional)}catch(a){console.error("Failed to fetch movie details:",a)}},f=e=>{if(!e)return{};const a=new DOMParser().parseFromString(e,"text/html"),c={};return a.querySelectorAll("li").forEach(y=>{var b,x,P,M;const S=(x=(b=y.querySelector(".key"))==null?void 0:b.textContent)==null?void 0:x.trim(),w=(M=(P=y.querySelector(".val"))==null?void 0:P.textContent)==null?void 0:M.trim();S&&w&&(c[S.replace(":","").trim()]=w)}),g.value=c,c},E=async e=>{try{const t=await l.get("/movieShows",{params:{movie_id:e}});d.value=t.data.data[e]}catch(t){console.error("Failed to fetch sessions:",t)}},O=async(e,t,a)=>{try{const c=await l.get("/showPlaces",{params:{movie_id:e,showdate:t,daytime:a}});_(e,t,a),v.value=c.data.data}catch(c){console.error("Failed to fetch available places:",c)}},_=(e,t,a)=>{h.value={movieId:e,showdate:t,daytime:a}};return{movies:s,currentPage:o,pageSize:n,totalPages:F,fetchMovies:A,sortMovies:T,getMoviesByPage:N,movie:r,sessions:d,availablePlaces:v,bookingStatus:p,fetchMovieDetails:D,fetchSessions:E,fetchAvailablePlaces:O,bookPlace:async(e,t,a,c)=>{try{const u=await l.post("/bookPlace",{movie_id:e,row:t.row,seat:t.seat,showdate:a,daytime:c});p.value=u.data.data,setTimeout(()=>{p.value=null},5e3)}catch(u){console.error("Failed to book place:",u)}},selectedSession:h,setSelectedSession:_,parsedAdditional:g}});function L(s){return new DOMParser().parseFromString(s,"text/html").documentElement.textContent||""}const U=["innerHTML"],$=k({__name:"sanitized-text",props:{rawText:{type:String,required:!0}},setup(s){const o=s,n=m(()=>L(o.rawText));return(r,d)=>(q(),z("p",{innerHTML:n.value,class:"sanitized-text"},null,8,U))}}),W=C($,[["__scopeId","data-v-a2c83379"]]),R={class:"relative overflow-hidden rounded-md bg-gradient-to-r from-gray-100 to-gray-300"},V=["src","alt"],j=k({__name:"optimized-image",props:{url:{type:String,required:!0},alt:{type:String,required:!0},width:{type:Number,default:400},height:{type:Number,default:0},className:{type:String,default:""}},setup(s){const o=s,n=m(()=>{const r=new URL(o.url,import.meta.url);return r.searchParams.set("w",o.width.toString()),o.height>0&&r.searchParams.set("h",o.height.toString()),r.searchParams.set("format","webp"),r.href});return(r,d)=>(q(),z("div",R,[H("img",{src:n.value,alt:s.alt,class:I([s.className,"transition-transform duration-300 ease-in-out transform hover:scale-115"]),decoding:"async",loading:"lazy"},null,10,V)]))}}),X=C(j,[["__scopeId","data-v-6bd8cf31"]]);export{X as O,W as S,Q as u};
